---
title: "SiSyn - Data Inventory"
output: 
  html_document: 
    toc: no
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE,echo=FALSE,message=FALSE,warning=FALSE}
## Code was compiled by Paul Julian
## contact info: pjulian@ufl.edu
## contact info: pauljulianphd@gmail.com

knitr::opts_chunk$set(echo = TRUE)
library(kableExtra)

#Libraries
library(AnalystHelper);
#devtools::install_github("SwampThingPaul/AnalystHelper")
library(plyr)
library(reshape)
library(openxlsx)
library(lubridate)

# GIS Libraries
library(tmap)
library(rgdal)
library(rgeos)
library(raster)

#Paths
wd="C:/Julian_LaCie/_GitHub/SiSyn"

#https://www.r-bloggers.com/structuring-r-projects/
#https://nicercode.github.io/blog/2013-04-05-projects/

paths=paste0(wd,c("/Plots/","/Export/","/Data/","/src/"))
#Folder.Maker(paths);#One and done. Creates folders in working directory.
plot.path=paths[1]
export.path=paths[2]
data.path=paths[3]

# Extra functions 
dms2dec <- function(dms, separators = c("º", "°", "\'", "\"")) {
  # version 1.0 (25 Sep 3013)
  # dms: a vector (or column) of latitude or longitude in degrees-minutes-seconds-hemisfere, e.g. 41° 34' 10.956" N (with or without spaces)
  # separators: the characters that are separating degrees, minutes and seconds in dms
  
  dms <- as.character(dms)
  dms <- gsub(pattern = " ", replacement = "", x = dms)
  for (s in separators) dms <- gsub(pattern = s, replacement = "_splitHere_", x = dms)
  
  splits <- strsplit(dms, split = "_splitHere_")
  n <- length(dms)
  deg <- min <- sec <- hem <- vector("character", n)
  
  for (i in 1:n) {
    deg[i] <- splits[[i]][1]
    min[i] <- splits[[i]][2]
    sec[i] <- splits[[i]][3]
    hem[i] <- splits[[i]][4]
  }
  
  dec <- as.numeric(deg) + (as.numeric(min) / 60) + (as.numeric(sec) / 3600)
  sign <- ifelse (hem %in% c("N", "E"), 1, -1)
  dec <- sign * dec
  return(dec)
}

# Helper variables 
wgs84=CRS("+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0")

# Data --------------------------------------------------------------------
param.list=data.frame(variable=c("Daily.Avg.Q.(Discharge)", "Instantaneous.Q.(Discharge)", "Stage.Height", 
                                 "Temp.C", "Conductivity", "Spec.Cond", "Turbidity", "TSS", "VSS", 
                                 "DSi", "TN","TDN", "DIN", "NOx","NO3","NO2", "NH4","DON", "TP","TDP", "PO4", "SRP", "DOC", 
                                 "TOC", "alkalinity", "ANC", "pH", "DIC", "Suspended.Chl", "Benthic.Chl", 
                                 "Na", "K", "Ca", "Mg", "SO4", "Cl"),
                      plot.val=1:36)
idvars=c("LTER","Site/Stream.Name","Sampling.Date")
param.vars=c("Daily.Avg.Q.(Discharge)", "Instantaneous.Q.(Discharge)", "Stage.Height", 
             "Temp.C", "Conductivity", "Spec.Cond", "Turbidity", "TSS", "VSS", 
             "DSi", "TN","TDN", "DIN", "NOx","NO3","NO2", "NH4","DON", "TP","TDP", "PO4", "SRP", "DOC", 
             "TOC", "alkalinity", "ANC", "pH", "DIC", "Suspended.Chl", "Benthic.Chl", 
             "Na", "K", "Ca", "Mg", "SO4", "Cl")
basin.vars=c("LTER","Site/Stream","Unique.ID","Latitude","Longitude")

data.filelist=list.files(data.path)

## ARCLTER
arc.dat=read.xlsx(paste0(data.path,"SiSyn_DataTemplate_ARCLTER_05012020.xlsx"),sheet=1,startRow=2,na.strings = "NA")
arc.dat$Sampling.Date=convertToDate(arc.dat$Sampling.Date)
arc.dat$dec.date=decimal_date(arc.dat$Sampling.Date)
names(arc.dat)
arc.note.Look=arc.dat[,c("Site/Stream.Name","Notes")]

arc.dat$site=arc.dat$'Site/Stream.Name'

#fix header
arc.dat=rename(arc.dat,c("Dsi"="DSi"))
arc.dat[,c("TDN","TDP","NO3","NO2","DON")]=as.numeric(NA); #Add empty columns for uniformity

##
arc.dat.melt=melt(arc.dat[,c(idvars,"dec.date",param.vars)],id.vars=c(idvars,"dec.date"))
arc.dat.melt=subset(arc.dat.melt,is.na(value)==F)
arc.dat.melt=merge(arc.dat.melt,param.list,"variable")
arc.dat.melt$site=arc.dat.melt$'Site/Stream.Name'
arc.dat.melt$variable=as.character(arc.dat.melt$variable)

#arc.dat.inv=ddply(arc.dat.melt,c("dec.date","variable","plot.val"),summarise,N.val=N.obs(site))
arc.dat.inv=ddply(arc.dat.melt,c("Sampling.Date","variable","plot.val"),summarise,N.val=N.obs(site))

arc.basin=read.xlsx(paste0(data.path,"SiSyn_DataTemplate_ARCLTER_05012020.xlsx"),sheet=4,startRow=4,na.strings = "NA")
arc.basin=arc.basin[,basin.vars]


## BcZO
bczo.dat=read.xlsx(paste0(data.path,"SiSyn_DataTemplate_BcCZO.xlsx"),sheet=1,startRow=2,na.strings = "NA")
bczo.dat$Sampling.Date=convertToDate(bczo.dat$Sampling.Date)
names(bczo.dat)
bczo.dat[,c("TN","TP","NO3","NO2","DON")]=as.numeric(NA);

bczo.dat=subset(bczo.dat,is.na('Site/Stream.Name')==F)

bczo.dat.melt=melt(bczo.dat[,c(idvars,param.vars)],id.vars=idvars)
bczo.dat.melt=subset(bczo.dat.melt,is.na(value)==F)

bczo.dat.melt=merge(bczo.dat.melt,param.list,"variable")
bczo.dat.melt$site=bczo.dat.melt$'Site/Stream.Name'
bczo.dat.melt$variable=as.character(bczo.dat.melt$variable)

bczo.dat.inv=ddply(bczo.dat.melt,c("Sampling.Date","variable","plot.val"),summarise,N.val=N.obs(site))

bczo.basin=read.xlsx(paste0(data.path,"SiSyn_DataTemplate_BcCZO.xlsx"),sheet=4,startRow=4,na.strings = "NA")
bczo.basin=bczo.basin[,basin.vars]

## Carey
carey.dat=read.xlsx(paste0(data.path,"SiSyn_DataTemplate_Carey_6.12.20.xlsx"),sheet=1,startRow=2,na.strings = "NA")
carey.dat$Sampling.Date=convertToDate(carey.dat$Sampling.Date)
carey.dat=carey.dat[2:nrow(carey.dat),]
carey.dat[,6:ncol(carey.dat)]=sapply(carey.dat[,6:ncol(carey.dat)],as.numeric)

carey.dat=rename(carey.dat,c("NO3.(uM)"="NO3","NO2.(uM)"="NO2"))
carey.dat[,c("TDN","TDP","DON")]=as.numeric(NA)

carey.dat.melt=melt(carey.dat[,c(idvars,param.vars)],id.vars=idvars)
carey.dat.melt=subset(carey.dat.melt,is.na(value)==F)

carey.dat.melt=merge(carey.dat.melt,param.list,"variable")
carey.dat.melt$site=carey.dat.melt$'Site/Stream.Name'
carey.dat.melt$variable=as.character(carey.dat.melt$variable)

carey.dat.inv=ddply(carey.dat.melt,c("Sampling.Date","variable","plot.val"),summarise,N.val=N.obs(site))

carey.basin=read.xlsx(paste0(data.path,"SiSyn_DataTemplate_Carey_6.12.20.xlsx"),sheet=4,startRow=4,na.strings = "NA")
carey.basin=carey.basin[,basin.vars]
carey.basin$Longitude=carey.basin$Longitude*-1

## Coal Creek
coal.dat=read.xlsx(paste0(data.path,"SiSyn_DataTemplate_Coal_Creek.xlsx"),sheet=1,startRow=2,na.strings = "NA")
coal.dat$Sampling.Date=convertToDate(coal.dat$Sampling.Date)
names(coal.dat)
coal.dat[,c("TDN","TDP","NO3","NO2")]=as.numeric(NA);

coal.dat.melt=melt(coal.dat[,c(idvars,param.vars)],id.vars=idvars)
coal.dat.melt=subset(coal.dat.melt,is.na(value)==F)
coal.dat.melt=merge(coal.dat.melt,param.list,"variable")
coal.dat.melt$site=coal.dat.melt$'Site/Stream.Name'
coal.dat.melt$variable=as.character(coal.dat.melt$variable)

coal.dat.inv=ddply(coal.dat.melt,c("Sampling.Date","variable","plot.val"),summarise,N.val=N.obs(site))

coal.basin=read.xlsx(paste0(data.path,"SiSyn_DataTemplate_Coal_Creek.xlsx"),sheet=4,startRow=4,na.strings = "NA")
coal.basin=coal.basin[,basin.vars]
coal.basin$Latitude=dms2dec(coal.basin$Latitude)
coal.basin$Latitude=coal.basin$Latitude*-1
coal.basin$Longitude=dms2dec(coal.basin$Longitude)

## CPCRW
cpcrw.dat=read.xlsx(paste0(data.path,"SiSyn_DataTemplate_CPCRW.xlsx"),sheet=1,startRow=2,na.strings = "NA")
cpcrw.dat$Sampling.Date=convertToDate(cpcrw.dat$Sampling.Date)
names(cpcrw.dat)
cpcrw.dat[,c("TDN","TDP","NO3","NO2","DON")]=as.numeric(NA);

cpcrw.dat.melt=melt(cpcrw.dat[,c(idvars,param.vars)],id.vars=idvars)
cpcrw.dat.melt=subset(cpcrw.dat.melt,is.na(value)==F)
cpcrw.dat.melt=merge(cpcrw.dat.melt,param.list,"variable")
cpcrw.dat.melt$site=cpcrw.dat.melt$'Site/Stream.Name'
cpcrw.dat.melt$variable=as.character(cpcrw.dat.melt$variable)

cpcrw.dat.inv=ddply(cpcrw.dat.melt,c("Sampling.Date","variable","plot.val"),summarise,N.val=N.obs(site))

cpcrw.basin=read.xlsx(paste0(data.path,"SiSyn_DataTemplate_CPCRW.xlsx"),sheet=4,startRow=4,na.strings = "NA")
cpcrw.basin=cpcrw.basin[,basin.vars]
cpcrw.basin$Latitude=dms2dec(cpcrw.basin$Latitude)
cpcrw.basin$Longitude=dms2dec(cpcrw.basin$Longitude)

#Knonza
konza.dat=read.xlsx(paste0(data.path,"SiSyn_DataTemplate_Konza.xlsx"),sheet=1,startRow=2,na.strings = "NA")
konza.dat$Sampling.Date=convertToDate(konza.dat$Sampling.Date)
names(konza.dat)
konza.dat[,c("TDN","TDP","NO2","DON")]=as.numeric(NA);
konza.dat=rename(konza.dat,c("no3"="NO3"))

konza.dat.melt=melt(konza.dat[,c(idvars,param.vars)],id.vars=idvars)
konza.dat.melt=subset(konza.dat.melt,is.na(value)==F)
konza.dat.melt=merge(konza.dat.melt,param.list,"variable")
konza.dat.melt$site=konza.dat.melt$'Site/Stream.Name'
konza.dat.melt$variable=as.character(konza.dat.melt$variable)

konza.dat.inv=ddply(konza.dat.melt,c("Sampling.Date","variable","plot.val"),summarise,N.val=N.obs(site))

konza.basin=read.xlsx(paste0(data.path,"SiSyn_DataTemplate_Konza.xlsx"),sheet=4,startRow=4,na.strings = "NA")
konza.basin=konza.basin[,basin.vars]
konza.basin$Latitude=dms2dec(konza.basin$Latitude)
konza.basin$Longitude=dms2dec(konza.basin$Longitude)
konza.basin[4,4]=konza.basin[4,4]*-1

## KRR
KRR.dat=read.xlsx(paste0(data.path,"SiSyn_DataTemplate_KRR.xlsx"),sheet=1,startRow=2,na.strings = "NA")
KRR.dat$Sampling.Date=convertToDate(KRR.dat$Sampling.Date)
names(KRR.dat)
KRR.dat[,c("TDN","TDP","NO3","NO2","DON")]=as.numeric(NA);

KRR.dat.melt=melt(KRR.dat[,c(idvars,param.vars)],id.vars=idvars)
KRR.dat.melt=subset(KRR.dat.melt,is.na(value)==F)
KRR.dat.melt=merge(KRR.dat.melt,param.list,"variable")
KRR.dat.melt$site=KRR.dat.melt$'Site/Stream.Name'
KRR.dat.melt$variable=as.character(KRR.dat.melt$variable)

KRR.dat.inv=ddply(KRR.dat.melt,c("Sampling.Date","variable","plot.val"),summarise,N.val=N.obs(site))

KRR.basin=read.xlsx(paste0(data.path,"SiSyn_DataTemplate_KRR.xlsx"),sheet=4,startRow=4,na.strings = "NA")
KRR.basin=KRR.basin[,basin.vars]

## MCM
MCM.dat=read.xlsx(paste0(data.path,"SiSyn_DataTemplate_MCM.xlsx"),sheet=1,startRow=2,na.strings = "NA")
MCM.dat$Sampling.Date=convertToDate(MCM.dat$Sampling.Date)
names(MCM.dat)
MCM.dat[,c("TDN","TDP","NO3","NO2","DON")]=as.numeric(NA);

MCM.dat.melt=melt(MCM.dat[,c(idvars,param.vars)],id.vars=idvars)
MCM.dat.melt=subset(MCM.dat.melt,is.na(value)==F)
MCM.dat.melt=merge(MCM.dat.melt,param.list,"variable")
MCM.dat.melt$site=MCM.dat.melt$'Site/Stream.Name'
MCM.dat.melt$variable=as.character(MCM.dat.melt$variable)

MCM.dat.inv=ddply(MCM.dat.melt,c("Sampling.Date","variable","plot.val"),summarise,N.val=N.obs(site))

MCM.basin=read.xlsx(paste0(data.path,"SiSyn_DataTemplate_MCM.xlsx"),sheet=4,startRow=4,na.strings = "NA")
MCM.basin=MCM.basin[,basin.vars]

## NWT
NWT.dat=read.xlsx(paste0(data.path,"SiSyn_DataTemplate_NWT.xlsx"),sheet=1,startRow=2,na.strings = "NA")
NWT.dat$Sampling.Date=convertToDate(NWT.dat$Sampling.Date)
names(NWT.dat)
NWT.dat[,c("TDN","TDP","NO3","NO2","DON")]=as.numeric(NA);
NWT.dat=rename(NWT.dat,c("InstantaneoNAs.Q.(Discharge)"="Instantaneous.Q.(Discharge)",
                         "CondNActivity"="Conductivity",
                         "TNArbidity"="Turbidity",
                         "SNAspended.Chl"="Suspended.Chl"))

NWT.dat.melt=melt(NWT.dat[,c(idvars,param.vars)],id.vars=idvars)
NWT.dat.melt=subset(NWT.dat.melt,is.na(value)==F)
NWT.dat.melt=merge(NWT.dat.melt,param.list,"variable")
NWT.dat.melt$site=NWT.dat.melt$'Site/Stream.Name'
NWT.dat.melt$variable=as.character(NWT.dat.melt$variable)

NWT.dat.inv=ddply(NWT.dat.melt,c("Sampling.Date","variable","plot.val"),summarise,N.val=N.obs(site))

NWT.basin=read.xlsx(paste0(data.path,"SiSyn_DataTemplate_NWT.xlsx"),sheet=4,startRow=4,na.strings = "NA")
NWT.basin=NWT.basin[,basin.vars]

## LMP
LMP.dat=read.xlsx(paste0(data.path,"SiSyn_DataTemplate_V1_LMP.xlsx"),sheet=1,startRow=2,na.strings = "NA")
LMP.dat$Sampling.Date=convertToDate(LMP.dat$Sampling.Date)
names(LMP.dat)
LMP.dat[,c("TDP","NO3","NO2","DON")]=as.numeric(NA);

LMP.dat.melt=melt(LMP.dat[,c(idvars,param.vars)],id.vars=idvars)
LMP.dat.melt=subset(LMP.dat.melt,is.na(value)==F)
LMP.dat.melt=merge(LMP.dat.melt,param.list,"variable")
LMP.dat.melt$site=LMP.dat.melt$'Site/Stream.Name'
LMP.dat.melt$variable=as.character(LMP.dat.melt$variable)

LMP.dat.inv=ddply(LMP.dat.melt,c("Sampling.Date","variable","plot.val"),summarise,N.val=N.obs(site))

LMP.basin=read.xlsx(paste0(data.path,"SiSyn_DataTemplate_V1_LMP.xlsx"),sheet=4,startRow=4,na.strings = "NA")
LMP.basin=LMP.basin[,basin.vars]

## LUQ
LUQ.dat=read.xlsx(paste0(data.path,"SiSyn_DataTemplate_V1_LUQ.xlsx"),sheet=1,startRow=2,na.strings = "NA")
LUQ.dat$Sampling.Date=convertToDate(LUQ.dat$Sampling.Date)
names(LUQ.dat)
LUQ.dat[,c("TDP","NO3","NO2","DON")]=as.numeric(NA);

LUQ.dat.melt=melt(LUQ.dat[,c(idvars,param.vars)],id.vars=idvars)
LUQ.dat.melt=subset(LUQ.dat.melt,is.na(value)==F)
LUQ.dat.melt=merge(LUQ.dat.melt,param.list,"variable")
LUQ.dat.melt$site=LUQ.dat.melt$'Site/Stream.Name'
LUQ.dat.melt$variable=as.character(LUQ.dat.melt$variable)

LUQ.dat.inv=ddply(LUQ.dat.melt,c("Sampling.Date","variable","plot.val"),summarise,N.val=N.obs(site))

LUQ.basin=read.xlsx(paste0(data.path,"SiSyn_DataTemplate_V1_LUQ.xlsx"),sheet=4,startRow=4,na.strings = "NA")
LUQ.basin=LUQ.basin[,basin.vars]
LUQ.basin=subset(LUQ.basin,is.na(Latitude)==F)

## PIE
pie.dat=read.xlsx(paste0(data.path,"SiSyn_DataTemplate_V1_PIEWatersheds.xlsx"),sheet=1,startRow=2,na.strings = "NA")
pie.dat$Sampling.Date=convertToDate(pie.dat$Sampling.Date)
names(pie.dat)
pie.dat[,c("TN","TDP","NO3","NO2","DON")]=as.numeric(NA);

pie.dat.melt=melt(pie.dat[,c(idvars,param.vars)],id.vars=idvars)
pie.dat.melt=subset(pie.dat.melt,is.na(value)==F)
pie.dat.melt=merge(pie.dat.melt,param.list,"variable")
pie.dat.melt$site=pie.dat.melt$'Site/Stream.Name'
pie.dat.melt$variable=as.character(pie.dat.melt$variable)

pie.dat.inv=ddply(pie.dat.melt,c("Sampling.Date","variable","plot.val"),summarise,N.val=N.obs(site))

pie.basin=read.xlsx(paste0(data.path,"SiSyn_DataTemplate_V1_PIEWatersheds.xlsx"),sheet=4,startRow=4,na.strings = "NA")
pie.basin=pie.basin[,basin.vars]

#lat long got flipped
pie.basin$long=pie.basin$Latitude
pie.basin$lat=pie.basin$Longitude
pie.basin$Longitude=pie.basin$long
pie.basin$Latitude=pie.basin$lat

pie.basin=pie.basin[,basin.vars]

# HJ Andrews
hja.dat=read.xlsx(paste0(data.path,"HJAndrewsSiSyn.xlsx"),sheet=1,startRow=2,na.strings = "NA")
hja.dat$Sampling.Date=convertToDate(hja.dat$Sampling.Date)
names(hja.dat)
hja.dat=rename(hja.dat,c("Si"="DSi"))

hja.dat[,c("TDN","TDP","NO3","NO2","DON","NH4")]=as.numeric(NA);
hja.dat$NH4=hja.dat$NH3

hja.dat.melt=melt(hja.dat[,c(idvars,param.vars)],id.vars=idvars)
hja.dat.melt=subset(hja.dat.melt,is.na(value)==F)
hja.dat.melt=merge(hja.dat.melt,param.list,"variable")
hja.dat.melt$site=hja.dat.melt$'Site/Stream.Name'
hja.dat.melt$variable=as.character(hja.dat.melt$variable)

hja.dat.inv=ddply(hja.dat.melt,c("Sampling.Date","variable","plot.val"),summarise,N.val=N.obs(site))

hja.basin=read.xlsx(paste0(data.path,"HJAndrewsSiSyn.xlsx"),sheet=4,startRow=4,na.strings = "NA")
hja.basin=hja.basin[,basin.vars]

# Sagehen
sage.dat=read.xlsx(paste0(data.path,"SagehenSiSyn.xlsx"),sheet=1,startRow=2,na.strings = "NA")
sage.dat$Sampling.Date=convertToDate(sage.dat$Sampling.Date)
names(sage.dat)

sage.dat[,c("TDN","TDP","NO3","NO2","DON")]=as.numeric(NA);
# sage.dat[,c(idvars,param.vars)]

chter.val=names(sage.dat)[lapply(sage.dat,class)=="character"]

tmp=melt(sage.dat[,c("Site/Stream.Name",chter.val[2:length(chter.val)])],id.vars="Site/Stream.Name")
spl=strsplit(as.character(tmp$value)," ")
tmp=data.frame(V1=sapply(spl,"[",1),V2=sapply(spl,"[",2),V3=sapply(spl,"[",3))
# head(sort(unique(tmp$V1),decreasing=T))
# head(sort(unique(tmp$V2),decreasing=T))
sort(unique(tmp$V3),decreasing=T)

## For now till we figure out coding
sage.dat[chter.val[2:length(chter.val)]]=sapply(sage.dat[chter.val[2:length(chter.val)]],as.numeric)

sage.dat.melt=melt(sage.dat[,c(idvars,param.vars)],id.vars=idvars)
sage.dat.melt=subset(sage.dat.melt,is.na(value)==F)
sage.dat.melt=merge(sage.dat.melt,param.list,"variable")
sage.dat.melt$site=sage.dat.melt$'Site/Stream.Name'
sage.dat.melt$variable=as.character(sage.dat.melt$variable)

sage.dat.inv=ddply(sage.dat.melt,c("Sampling.Date","variable","plot.val"),summarise,N.val=N.obs(site))

sage.basin=read.xlsx(paste0(data.path,"SagehenSiSyn.xlsx"),sheet=4,startRow=4,na.strings = "NA")
sage.basin=sage.basin[,basin.vars]
sage.basin$Longitude=sage.basin$Longitude*-1

# UMR
umr.dat=read.xlsx(paste0(data.path,"SiSyn_DataTemplate_UMR.xlsx"),sheet=1,startRow=2,na.strings = "NA")
umr.dat$Sampling.Date=convertToDate(umr.dat$Sampling.Date)
names(umr.dat)

umr.dat[,c("TDN","TDP","NO3","NO2","DON")]=as.numeric(NA);
# umr.dat[,c(idvars,param.vars)]

umr.dat.melt=melt(umr.dat[,c(idvars,param.vars)],id.vars=idvars)
umr.dat.melt=subset(umr.dat.melt,is.na(value)==F)
umr.dat.melt=merge(umr.dat.melt,param.list,"variable")
umr.dat.melt$site=umr.dat.melt$'Site/Stream.Name'
umr.dat.melt$variable=as.character(umr.dat.melt$variable)

umr.dat.inv=ddply(umr.dat.melt,c("Sampling.Date","variable","plot.val"),summarise,N.val=N.obs(site))

umr.basin=read.xlsx(paste0(data.path,"SiSyn_DataTemplate_UMR.xlsx"),sheet=4,startRow=4,na.strings = "NA")
umr.basin=umr.basin[,basin.vars]

##
sites=rbind(cpcrw.basin,KRR.basin)
sites=rbind(sites,arc.basin)
sites=rbind(sites,LMP.basin)
sites=rbind(sites,LUQ.basin)
sites=rbind(sites,pie.basin)
sites=rbind(sites,carey.basin)
sites=rbind(sites,coal.basin)
sites=rbind(sites,konza.basin)
sites=rbind(sites,MCM.basin)
sites=rbind(sites,NWT.basin)
sites=rbind(sites,bczo.basin)
sites=rbind(sites,hja.basin)
sites=rbind(sites,sage.basin)
sites=rbind(sites,umr.basin)

sites$Longitude=as.numeric(sites$Longitude)
# subset(sites,is.na(Longitude)==T)
sites=subset(sites,is.na(Longitude)==F)


sites=SpatialPointsDataFrame(coords=sites[,c("Longitude","Latitude")],
                                   data=sites,
                                   proj4string = wgs84)
tmap_mode("view")
```


**FROM POLES TO TROPICS: A MULTI-BIOME SYNTHESIS INVESTIGATING THE CONTROLS ON RIVER SI EXPORTS**

[Project Overview](https://lternet.edu/working-groups/river-si-exports/){target="_blank"}

## Spatial Distribution of Sites 

```{r map, out.width="100%",fig.align='center', echo=FALSE,warning=FALSE, message=FALSE}
tm_basemap(leaflet::providers$Esri.WorldImagery,alpha=0.9)+
  tm_shape(sites,name="Available Data")+tm_dots(col="red",popup.vars=c("LTER","Site/Stream","Unique.ID","Latitude","Longitude"),size=0.075)

```

<center>Monitoring locations of available data to date `r Sys.Date()`. </center>

## Period of Record Data Inventory

The following plots provide a graphical depiction of data on the Data set level (i.e. Bonanza LTER, Lamprey River, etc.). 

# {.tabset .tabset-fade}

```{r,echo=FALSE,warning=FALSE, message=FALSE}
xlim.val=as.Date(c("1983-01-01","2020-01-01"));xmaj=seq(xlim.val[1],xlim.val[2],"10 years");xmin=seq(xlim.val[1],xlim.val[2],"1 years")
```

## Arctic LTER
```{r ARC,fig.width=7,fig.height=5.5,fig.align='center',echo=FALSE,warning=FALSE, message=FALSE,fig.cap='Arctic LTER period of record parameter inventory for all sites.'}
par(family="serif",mar=c(1,3,0.75,0.5),oma=c(2,6.5,0.5,0.5));

ylim.val=c(1,nrow(param.list));ymaj=seq(ylim.val[1],ylim.val[2],1)
plot(xlim.val,0:1,type="n",ylim=ylim.val,xlim=xlim.val,axes=F,ylab=NA,xlab=NA)
abline(v=xmin,h=ymaj,lty=2,col="grey80")
with(arc.dat.inv,points(Sampling.Date,plot.val,pch="|",col=adjustcolor("red",0.5)))
axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"))
axis_fun(2,ymaj,ymaj,param.list$variable,cex=0.8)
box(lwd=1)
mtext(side=3,"Arctic LTER",cex=0.8,adj=0)
mtext(side=1,line=1.75,"Date (Month-Year)")

```


```{r ARC site,fig.width=6.5,fig.height=7,fig.align='center',echo=FALSE,warning=FALSE, message=FALSE,fig.cap='Silica data inventory for sites wihtin the Arctic LTER (Note: not all monitoring locations may be visible (i.e. labeled) on the figure). '}
arc.dat$site=arc.dat$`Site/Stream.Name`
arc.dat$CY=as.numeric(format(arc.dat$Sampling.Date,"%Y"))
arc.site.inv=ddply(arc.dat,c("Sampling.Date","site"),summarise,N.val=N.obs(DSi))
arc.site.inv=merge(arc.site.inv,data.frame(site=unique(arc.site.inv$site),plot.val=1:length(unique(arc.site.inv$site))))
arc.site.yrs=ddply(arc.dat,c("site","CY"),summarise,n.val=N.obs(DSi))
# mean(ddply(subset(arc.site.yrs,n.val>4),"site",summarise,n.val=N.obs(CY))$n.val)

par(family="serif",mar=c(1,3,0.75,0.5),oma=c(2,5,0.5,0.5));

ylim.val=c(1,length(unique(arc.site.inv$site)));ymaj=seq(ylim.val[1],ylim.val[2],1)
plot(xlim.val,ylim.val,type="n",ylim=c(0.5-ylim.val[1],ylim.val[2]+0.5),xlim=xlim.val,axes=F,ylab=NA,xlab=NA,yaxs="i")
abline(v=xmin,lty=2,col="grey80",lwd=0.75)
with(arc.site.inv,points(Sampling.Date,plot.val,pch="|",col=adjustcolor("red",0.5)))
axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"))
axis_fun(2,ymaj,ymaj,unique(arc.site.inv$site),cex=0.5)
box(lwd=1)
mtext(side=3,"Arctic LTER - DSi data",cex=0.8,adj=0)
mtext(side=1,line=1.75,"Date (Month-Year)")

```

**Number of sites:** `r length(unique(arc.site.inv$site))`

**Mean number of site years (with >4 samples per calendar year):** `r round(mean(ddply(subset(arc.site.yrs,n.val>4),"site",summarise,n.val=N.obs(CY))$n.val),2)`

<br>

## Bonanza Creek LTER
```{r BCLTER,fig.width=6.5,fig.height=5.5,fig.align='center',echo=FALSE,warning=FALSE, message=FALSE,fig.cap='Bonanza Creek LTER/Caribou-Poker Creeks Research Watershed period of record parameter inventory for all sites.'}
par(family="serif",mar=c(1,3,0.75,0.5),oma=c(2,3.5,0.5,0.5));

ylim.val=c(1,nrow(param.list));ymaj=seq(ylim.val[1],ylim.val[2],1)
plot(xlim.val,0:1,type="n",ylim=ylim.val,xlim=xlim.val,axes=F,ylab=NA,xlab=NA)
abline(v=xmin,h=ymaj,lty=2,col="grey80")
with(cpcrw.dat.inv,points(Sampling.Date,plot.val,pch="|",col=adjustcolor("red",0.5)))
axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"))
axis_fun(2,ymaj,ymaj,param.list$variable,cex=0.8)
box(lwd=1)
mtext(side=3,"Bonanza Creek LTER",cex=0.8, adj=0)
mtext(side=1,line=1.75,"Date (Month-Year)")

```


```{r BC site,fig.width=6.5,fig.height=5,fig.align='center',echo=FALSE,warning=FALSE, message=FALSE,fig.cap='Silica data inventory for sites wihtin the Bonanza Creek LTER/Caribou-Poker Creeks Research Watershed (Note: not all monitoring locations may be visible (i.e. labeled) on the figure). '}
cpcrw.dat$site=cpcrw.dat$`Site/Stream.Name`
cpcrw.dat$CY=as.numeric(format(cpcrw.dat$Sampling.Date,"%Y"))
cpcrw.site.inv=ddply(cpcrw.dat,c("Sampling.Date","site"),summarise,N.val=N.obs(DSi))
cpcrw.site.inv=merge(cpcrw.site.inv,data.frame(site=unique(cpcrw.site.inv$site),plot.val=1:length(unique(cpcrw.site.inv$site))))

cpcrw.site.yrs=ddply(cpcrw.dat,c("site","CY"),summarise,n.val=N.obs(DSi))


par(family="serif",mar=c(1,3,0.75,0.5),oma=c(2,6.5,0.5,0.5));

ylim.val=c(1,length(unique(cpcrw.site.inv$site)));ymaj=seq(ylim.val[1],ylim.val[2],1)
plot(xlim.val,ylim.val,type="n",ylim=c(ylim.val[1],ylim.val[2]),xlim=xlim.val,axes=F,ylab=NA,xlab=NA)
abline(v=xmin,lty=2,col="grey80",lwd=0.75)
with(cpcrw.site.inv,points(Sampling.Date,plot.val,pch="|",col=adjustcolor("red",0.5)))
axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"))
axis_fun(2,ymaj,ymaj,unique(cpcrw.site.inv$site),cex=1)
box(lwd=1)
mtext(side=3,"Bonanza Creek LTER - DSi data",cex=0.8,adj=0)
mtext(side=1,line=1.75,"Date (Month-Year)")

```


**Number of sites:** `r length(unique(cpcrw.site.inv$site))`

**Mean number of site years (with >4 samples per calendar year):** `r round(mean(ddply(subset(cpcrw.site.yrs,n.val>4),"site",summarise,n.val=N.obs(CY))$n.val),2)`

<br>

## H.J. Andrews LTER
```{r HJA,fig.width=7,fig.height=5.5,fig.align='center',echo=FALSE,warning=FALSE, message=FALSE,fig.cap='H.J. Andrews LTER period of record parameter inventory for all sites.'}
par(family="serif",mar=c(1,3,0.75,0.5),oma=c(2,6.5,0.5,0.5));

ylim.val=c(1,nrow(param.list));ymaj=seq(ylim.val[1],ylim.val[2],1)
plot(xlim.val,0:1,type="n",ylim=ylim.val,xlim=xlim.val,axes=F,ylab=NA,xlab=NA)
abline(v=xmin,h=ymaj,lty=2,col="grey80")
with(subset(hja.dat.inv,Sampling.Date>xlim.val[1]),points(Sampling.Date,plot.val,pch="|",col=adjustcolor("red",0.5)))
axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"))
axis_fun(2,ymaj,ymaj,param.list$variable,cex=0.8)
box(lwd=1)
mtext(side=3,"H.J. Andrews (LTER)",cex=0.8, adj=0)
mtext(side=1,line=1.75,"Date (Month-Year)")

```

```{r HJA site,fig.width=6.5,fig.height=5,fig.align='center',echo=FALSE,warning=FALSE, message=FALSE,fig.cap='Silica data inventory for sites wihtin the H.J. Andrews LTER. '}
hja.dat$site=hja.dat$`Site/Stream.Name`
hja.dat$CY=as.numeric(format(hja.dat$Sampling.Date,"%Y"))
hja.site.inv=ddply(hja.dat,c("Sampling.Date","site"),summarise,N.val=N.obs(DSi))
hja.site.inv=merge(hja.site.inv,data.frame(site=unique(hja.site.inv$site),plot.val=1:length(unique(hja.site.inv$site))))

hja.site.yrs=ddply(hja.dat,c("site","CY"),summarise,n.val=N.obs(DSi))


par(family="serif",mar=c(1,3,0.75,0.5),oma=c(2,6.5,0.5,0.5));

ylim.val=c(1,length(unique(hja.site.inv$site)));ymaj=seq(ylim.val[1],ylim.val[2],1)
plot(xlim.val,ylim.val,type="n",ylim=c(ylim.val[1],ylim.val[2]),xlim=xlim.val,axes=F,ylab=NA,xlab=NA)
abline(v=xmin,lty=2,col="grey80",lwd=0.75)
with(hja.site.inv,points(Sampling.Date,plot.val,pch="|",col=adjustcolor("red",0.5)))
axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"))
axis_fun(2,ymaj,ymaj,unique(hja.site.inv$site),cex=1)
box(lwd=1)
mtext(side=3,"H.J. Andrews LTER - DSi data",cex=0.8,adj=0)
mtext(side=1,line=1.75,"Date (Month-Year)")

```


**Number of sites:** `r length(unique(hja.site.inv$site))`

**Mean number of site years (with >4 samples per calendar year):** `r round(mean(ddply(subset(hja.site.yrs,n.val>4),"site",summarise,n.val=N.obs(CY))$n.val),2)`

<br>

## Sagehen Creek (non-LTER)

<p style="color:red;"><u>Currently working through QA/QC, therefore this may not be a true representation of the avalable data. </u><p>

```{r sage,fig.width=7,fig.height=5.5,fig.align='center',echo=FALSE,warning=FALSE, message=FALSE,fig.cap='Sagehen Creek period of record parameter inventory for all sites.'}
par(family="serif",mar=c(1,3,0.75,0.5),oma=c(2,6.5,0.5,0.5));

ylim.val=c(1,nrow(param.list));ymaj=seq(ylim.val[1],ylim.val[2],1)
plot(xlim.val,0:1,type="n",ylim=ylim.val,xlim=xlim.val,axes=F,ylab=NA,xlab=NA)
abline(v=xmin,h=ymaj,lty=2,col="grey80")
with(subset(sage.dat.inv,Sampling.Date>xlim.val[1]),points(Sampling.Date,plot.val,pch="|",col=adjustcolor("red",0.5)))
axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"))
axis_fun(2,ymaj,ymaj,param.list$variable,cex=0.8)
box(lwd=1)
mtext(side=3,"Sagehen Creek (non-LTER)",cex=0.8, adj=0)
mtext(side=1,line=1.75,"Date (Month-Year)")

```

```{r sage site,fig.width=6.5,fig.height=3,fig.align='center',echo=FALSE,warning=FALSE, message=FALSE,fig.cap='Silica data inventory for sites wihtin the Sagehen Creek. '}
sage.dat$site=sage.dat$`Site/Stream.Name`
sage.dat$CY=as.numeric(format(sage.dat$Sampling.Date,"%Y"))
sage.site.inv=ddply(sage.dat,c("Sampling.Date","site"),summarise,N.val=N.obs(DSi))
sage.site.inv=merge(sage.site.inv,data.frame(site=unique(sage.site.inv$site),plot.val=1:length(unique(sage.site.inv$site))))

sage.site.yrs=ddply(sage.dat,c("site","CY"),summarise,n.val=N.obs(DSi))

par(family="serif",mar=c(1,3,0.75,0.5),oma=c(2,6.5,0.5,0.5));

ylim.val=c(1,length(unique(sage.site.inv$site)));ymaj=seq(ylim.val[1],ylim.val[2],1)
plot(xlim.val,ylim.val,type="n",ylim=c(ylim.val[1],ylim.val[2]),xlim=xlim.val,axes=F,ylab=NA,xlab=NA)
abline(v=xmin,lty=2,col="grey80",lwd=0.75)
with(sage.site.inv,points(Sampling.Date,plot.val,pch="|",col=adjustcolor("red",0.5)))
axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"))
axis_fun(2,ymaj,ymaj,unique(sage.site.inv$site),cex=1)
box(lwd=1)
mtext(side=3,"Sagehen Creek - DSi data",cex=0.8,adj=0)
mtext(side=1,line=1.75,"Date (Month-Year)")

```


**Number of sites:** `r length(unique(sage.site.inv$site))`

**Mean number of site years (with >4 samples per calendar year):** `r round(mean(ddply(subset(sage.site.yrs,n.val>4),"site",summarise,n.val=N.obs(CY))$n.val),2)`

<br>

## Boulder Critical Zone Observatory (CZO network)

```{r BcCZO,fig.width=7,fig.height=5.5,fig.align='center',echo=FALSE,warning=FALSE, message=FALSE,fig.cap='Boulder Critical Zone Observatory period of record parameter inventory for all sites.'}
par(family="serif",mar=c(1,3,0.75,0.5),oma=c(2,6.5,0.5,0.5));

ylim.val=c(1,nrow(param.list));ymaj=seq(ylim.val[1],ylim.val[2],1)
plot(xlim.val,0:1,type="n",ylim=ylim.val,xlim=xlim.val,axes=F,ylab=NA,xlab=NA)
abline(v=xmin,h=ymaj,lty=2,col="grey80")
with(bczo.dat.inv,points(Sampling.Date,plot.val,pch="|",col=adjustcolor("red",0.5)))
axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"))
axis_fun(2,ymaj,ymaj,param.list$variable,cex=0.8)
box(lwd=1)
mtext(side=3,"Boulder CZO",cex=0.8, adj=0)
mtext(side=1,line=1.75,"Date (Month-Year)")

```

```{r bczo site,fig.width=6.5,fig.height=5,fig.align='center',echo=FALSE,warning=FALSE, message=FALSE,fig.cap='Silica data inventory for sites wihtin the Boulder Critical Zone Observatory. '}
bczo.dat$site=bczo.dat$`Site/Stream.Name`
bczo.dat$CY=as.numeric(format(bczo.dat$Sampling.Date,"%Y"))
bczo.site.inv=ddply(bczo.dat,c("Sampling.Date","site"),summarise,N.val=N.obs(DSi))
bczo.site.inv=merge(bczo.site.inv,data.frame(site=unique(bczo.site.inv$site),plot.val=1:length(unique(bczo.site.inv$site))))

bczo.site.yrs=ddply(bczo.dat,c("site","CY"),summarise,n.val=N.obs(DSi))

par(family="serif",mar=c(1,3,0.75,0.5),oma=c(2,6.5,0.5,0.5));

ylim.val=c(1,length(unique(bczo.site.inv$site)));ymaj=seq(ylim.val[1],ylim.val[2],1)
plot(xlim.val,ylim.val,type="n",ylim=c(ylim.val[1],ylim.val[2]),xlim=xlim.val,axes=F,ylab=NA,xlab=NA)
abline(v=xmin,lty=2,col="grey80",lwd=0.75)
with(bczo.site.inv,points(Sampling.Date,plot.val,pch="|",col=adjustcolor("red",0.5)))
axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"))
axis_fun(2,ymaj,ymaj,unique(bczo.site.inv$site),cex=1)
box(lwd=1)
mtext(side=3,"Boulder CZO - DSi data",cex=0.8,adj=0)
mtext(side=1,line=1.75,"Date (Month-Year)")

```


**Number of sites:** `r length(unique(bczo.site.inv$site))`

**Mean number of site years (with >4 samples per calendar year):** `r round(mean(ddply(subset(bczo.site.yrs,n.val>4),"site",summarise,n.val=N.obs(CY))$n.val),2)`

<br>

## Niwot Ridge LTER
```{r NWT,fig.width=7,fig.height=5.5,fig.align='center',echo=FALSE,warning=FALSE, message=FALSE,fig.cap='Niwot Ridge LTER period of record parameter inventory for all sites.'}
par(family="serif",mar=c(1,3,0.75,0.5),oma=c(2,6.5,0.5,0.5));

ylim.val=c(1,nrow(param.list));ymaj=seq(ylim.val[1],ylim.val[2],1)
plot(xlim.val,0:1,type="n",ylim=ylim.val,xlim=xlim.val,axes=F,ylab=NA,xlab=NA)
abline(v=xmin,h=ymaj,lty=2,col="grey80")
with(NWT.dat.inv,points(Sampling.Date,plot.val,pch="|",col=adjustcolor("red",0.5)))
axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"))
axis_fun(2,ymaj,ymaj,param.list$variable,cex=0.8)
box(lwd=1)
mtext(side=3,"Niwot Ridge LTER",cex=0.8, adj=0)
mtext(side=1,line=1.75,"Date (Month-Year)")

```


```{r NWT site,fig.width=6.5,fig.height=4,fig.align='center',echo=FALSE,warning=FALSE, message=FALSE,fig.cap='Silica data inventory for sites wihtin the Niwot Ridge LTER. '}
NWT.dat$site=NWT.dat$`Site/Stream.Name`
NWT.dat$CY=as.numeric(format(NWT.dat$Sampling.Date,"%Y"))
NWT.site.inv=ddply(NWT.dat,c("Sampling.Date","site"),summarise,N.val=N.obs(DSi))
NWT.site.inv=merge(NWT.site.inv,data.frame(site=unique(NWT.site.inv$site),plot.val=1:length(unique(NWT.site.inv$site))))

NWT.site.yrs=ddply(NWT.dat,c("site","CY"),summarise,n.val=N.obs(DSi))

par(family="serif",mar=c(1,3,0.75,0.5),oma=c(2,6.5,0.5,0.5));

ylim.val=c(1,length(unique(NWT.site.inv$site)));ymaj=seq(ylim.val[1],ylim.val[2],1)
plot(xlim.val,ylim.val,type="n",ylim=c(ylim.val[1],ylim.val[2]),xlim=xlim.val,axes=F,ylab=NA,xlab=NA)
abline(v=xmin,lty=2,col="grey80",lwd=0.75)
with(NWT.site.inv,points(Sampling.Date,plot.val,pch="|",col=adjustcolor("red",0.5)))
axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"))
axis_fun(2,ymaj,ymaj,unique(NWT.site.inv$site),cex=1)
box(lwd=1)
mtext(side=3,"Niwot Ridge LTER - DSi data",cex=0.8,adj=0)
mtext(side=1,line=1.75,"Date (Month-Year)")

```


**Number of sites:** `r length(unique(NWT.site.inv$site))`

**Mean number of site years (with >4 samples per calendar year):** `r round(mean(ddply(subset(NWT.site.yrs,n.val>4),"site",summarise,n.val=N.obs(CY))$n.val),2)`

<br>


## East River Scientific Focus Area (non-LTER)
```{r DOE_SFA,fig.width=7,fig.height=5.5,fig.align='center',echo=FALSE,warning=FALSE, message=FALSE,fig.cap='East River Scientific Focus Area period of record parameter inventory for all sites.'}
par(family="serif",mar=c(1,3,0.75,0.5),oma=c(2,6.5,0.5,0.5));

ylim.val=c(1,nrow(param.list));ymaj=seq(ylim.val[1],ylim.val[2],1)
plot(xlim.val,0:1,type="n",ylim=ylim.val,xlim=xlim.val,axes=F,ylab=NA,xlab=NA)
abline(v=xmin,h=ymaj,lty=2,col="grey80")
with(coal.dat.inv,points(Sampling.Date,plot.val,pch="|",col=adjustcolor("red",0.5)))
axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"))
axis_fun(2,ymaj,ymaj,param.list$variable,cex=0.8)
box(lwd=1)
mtext(side=3,"East River SFA",cex=0.8, adj=0)
mtext(side=1,line=1.75,"Date (Month-Year)")

```

```{r DOE_SFA site,fig.width=6.5,fig.height=3,fig.align='center',echo=FALSE,warning=FALSE, message=FALSE,fig.cap='Silica data inventory for sites wihtin the East River Scientific Focus Area. '}
coal.dat$site=coal.dat$`Site/Stream.Name`
coal.dat$CY=as.numeric(format(coal.dat$Sampling.Date,"%Y"))
coal.site.inv=ddply(coal.dat,c("Sampling.Date","site"),summarise,N.val=N.obs(DSi))
coal.site.inv=merge(coal.site.inv,data.frame(site=unique(coal.site.inv$site),plot.val=1:length(unique(coal.site.inv$site))))

coal.site.yrs=ddply(coal.dat,c("site","CY"),summarise,n.val=N.obs(DSi))

par(family="serif",mar=c(1,3,0.75,0.5),oma=c(2,6.5,0.5,0.5));

ylim.val=c(1,length(unique(coal.site.inv$site)));ymaj=seq(ylim.val[1],ylim.val[2],1)
plot(xlim.val,ylim.val,type="n",ylim=c(ylim.val[1],ylim.val[2]),xlim=xlim.val,axes=F,ylab=NA,xlab=NA)
abline(v=xmin,lty=2,col="grey80",lwd=0.75)
with(coal.site.inv,points(Sampling.Date,plot.val,pch="|",col=adjustcolor("red",0.5)))
axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"))
axis_fun(2,ymaj,ymaj,unique(coal.site.inv$site),cex=1)
box(lwd=1)
mtext(side=3,"East River SFA - DSi data",cex=0.8,adj=0)
mtext(side=1,line=1.75,"Date (Month-Year)")

```


**Number of sites:** `r length(unique(coal.site.inv$site))`

**Mean number of site years (with >4 samples per calendar year):** `r round(mean(ddply(subset(coal.site.yrs,n.val>4),"site",summarise,n.val=N.obs(CY))$n.val),2)`

<br>

## Konza Prairie LTER
```{r KNZ,fig.width=7,fig.height=5.5,fig.align='center',echo=FALSE,warning=FALSE, message=FALSE,fig.cap='Konza Prairie LTER period of record parameter inventory for all sites.'}
par(family="serif",mar=c(1,3,0.75,0.5),oma=c(2,6.5,0.5,0.5));

ylim.val=c(1,nrow(param.list));ymaj=seq(ylim.val[1],ylim.val[2],1)
plot(xlim.val,0:1,type="n",ylim=ylim.val,xlim=xlim.val,axes=F,ylab=NA,xlab=NA)
abline(v=xmin,h=ymaj,lty=2,col="grey80")
with(konza.dat.inv,points(Sampling.Date,plot.val,pch="|",col=adjustcolor("red",0.5)))
axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"))
axis_fun(2,ymaj,ymaj,param.list$variable,cex=0.8)
box(lwd=1)
mtext(side=3,"Konza Prairie LTER",cex=0.8, adj=0)
mtext(side=1,line=1.75,"Date (Month-Year)")

```

```{r KNZ site,fig.width=6.5,fig.height=4,fig.align='center',echo=FALSE,warning=FALSE, message=FALSE,fig.cap='Silica data inventory for sites wihtin the Konza Prairie LTER. '}
konza.dat$site=konza.dat$`Site/Stream.Name`
konza.dat$CY=as.numeric(format(konza.dat$Sampling.Date,"%Y"))
konza.site.inv=ddply(konza.dat,c("Sampling.Date","site"),summarise,N.val=N.obs(DSi))
konza.site.inv=merge(konza.site.inv,data.frame(site=unique(konza.site.inv$site),plot.val=1:length(unique(konza.site.inv$site))))

konza.site.yrs=ddply(konza.dat,c("site","CY"),summarise,n.val=N.obs(DSi))

par(family="serif",mar=c(1,3,0.75,0.5),oma=c(2,6.5,0.5,0.5));

ylim.val=c(1,length(unique(konza.site.inv$site)));ymaj=seq(ylim.val[1],ylim.val[2],1)
plot(xlim.val,ylim.val,type="n",ylim=c(ylim.val[1],ylim.val[2]),xlim=xlim.val,axes=F,ylab=NA,xlab=NA)
abline(v=xmin,lty=2,col="grey80",lwd=0.75)
with(konza.site.inv,points(Sampling.Date,plot.val,pch="|",col=adjustcolor("red",0.5)))
axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"))
axis_fun(2,ymaj,ymaj,unique(konza.site.inv$site),cex=1)
box(lwd=1)
mtext(side=3,"Konza Prairie LTER - DSi data",cex=0.8,adj=0)
mtext(side=1,line=1.75,"Date (Month-Year)")

```


**Number of sites:** `r length(unique(konza.site.inv$site))`

**Mean number of site years (with >4 samples per calendar year):** `r round(mean(ddply(subset(konza.site.yrs,n.val>4),"site",summarise,n.val=N.obs(CY))$n.val),2)`

<br>

## Lamprey River Hydrologic Observatory (non-LTER)
```{r LMP,fig.width=7,fig.height=5.5,fig.align='center',echo=FALSE,warning=FALSE, message=FALSE,fig.cap='Lamprey River Hydrologic Observatory period of record parameter inventory for all sites.'}
par(family="serif",mar=c(1,3,0.75,0.5),oma=c(2,6.5,0.5,0.5));

ylim.val=c(1,nrow(param.list));ymaj=seq(ylim.val[1],ylim.val[2],1)
plot(xlim.val,0:1,type="n",ylim=ylim.val,xlim=xlim.val,axes=F,ylab=NA,xlab=NA)
abline(v=xmin,h=ymaj,lty=2,col="grey80")
with(LMP.dat.inv,points(Sampling.Date,plot.val,pch="|",col=adjustcolor("red",0.5)))
axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"))
axis_fun(2,ymaj,ymaj,param.list$variable,cex=0.8)
box(lwd=1)
mtext(side=3,"Lamprey River Hydrologic Observatory",cex=0.8, adj=0)
mtext(side=1,line=1.75,"Date (Month-Year)")
```

```{r LMP site,fig.width=6.5,fig.height=5,fig.align='center',echo=FALSE,warning=FALSE, message=FALSE,fig.cap='Silica data inventory for sites wihtin the Lamprey River Hydrologic Observatory. '}
LMP.dat$site=LMP.dat$`Site/Stream.Name`
LMP.dat$CY=as.numeric(format(LMP.dat$Sampling.Date,"%Y"))
LMP.site.inv=ddply(LMP.dat,c("Sampling.Date","site"),summarise,N.val=N.obs(DSi))
LMP.site.inv=merge(LMP.site.inv,data.frame(site=unique(LMP.site.inv$site),plot.val=1:length(unique(LMP.site.inv$site))))

LMP.site.yrs=ddply(LMP.dat,c("site","CY"),summarise,n.val=N.obs(DSi))

par(family="serif",mar=c(1,3,0.75,0.5),oma=c(2,6.5,0.5,0.5));

ylim.val=c(1,length(unique(LMP.site.inv$site)));ymaj=seq(ylim.val[1],ylim.val[2],1)
plot(xlim.val,ylim.val,type="n",ylim=c(ylim.val[1],ylim.val[2]),xlim=xlim.val,axes=F,ylab=NA,xlab=NA)
abline(v=xmin,lty=2,col="grey80",lwd=0.75)
with(LMP.site.inv,points(Sampling.Date,plot.val,pch="|",col=adjustcolor("red",0.5)))
axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"))
axis_fun(2,ymaj,ymaj,unique(LMP.site.inv$site),cex=1)
box(lwd=1)
mtext(side=3,"Lamprey River Hydrologic Observatory - DSi data",cex=0.8,adj=0)
mtext(side=1,line=1.75,"Date (Month-Year)")

```


**Number of sites:** `r length(unique(LMP.site.inv$site))`

**Mean number of site years (with >4 samples per calendar year):** `r round(mean(ddply(subset(LMP.site.yrs,n.val>4),"site",summarise,n.val=N.obs(CY))$n.val),2)`

<br>

## Plum Island Ecosystems LTER
```{r PIE,fig.width=7,fig.height=5.5,fig.align='center',echo=FALSE,warning=FALSE, message=FALSE,fig.cap='Plum Island Ecosystems LTER period of record parameter inventory for all sites.'}

par(family="serif",mar=c(1,3,0.75,0.5),oma=c(2,6.5,0.5,0.5));

ylim.val=c(1,nrow(param.list));ymaj=seq(ylim.val[1],ylim.val[2],1)
plot(xlim.val,0:1,type="n",ylim=ylim.val,xlim=xlim.val,axes=F,ylab=NA,xlab=NA)
abline(v=xmin,h=ymaj,lty=2,col="grey80")
with(pie.dat.inv,points(Sampling.Date,plot.val,pch="|",col=adjustcolor("red",0.5)))
axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"))
axis_fun(2,ymaj,ymaj,param.list$variable,cex=0.8)
box(lwd=1)
mtext(side=3,"Plum Island Ecosystems LTER",cex=0.8, adj=0)
mtext(side=1,line=1.75,"Date (Month-Year)")
```

```{r PIE site,fig.width=6.5,fig.height=5,fig.align='center',echo=FALSE,warning=FALSE, message=FALSE,fig.cap='Silica data inventory for sites wihtin the Plum Island Ecosystems LTER. '}
pie.dat$site=pie.dat$`Site/Stream.Name`
pie.dat$CY=as.numeric(format(pie.dat$Sampling.Date,"%Y"))
pie.site.inv=ddply(pie.dat,c("Sampling.Date","site"),summarise,N.val=N.obs(DSi))
pie.site.inv=merge(pie.site.inv,data.frame(site=unique(pie.site.inv$site),plot.val=1:length(unique(pie.site.inv$site))))

pie.site.yrs=ddply(pie.dat,c("site","CY"),summarise,n.val=N.obs(DSi))

par(family="serif",mar=c(1,3,0.75,0.5),oma=c(2,6.5,0.5,0.5));

ylim.val=c(1,length(unique(pie.site.inv$site)));ymaj=seq(ylim.val[1],ylim.val[2],1)
plot(xlim.val,ylim.val,type="n",ylim=c(ylim.val[1],ylim.val[2]),xlim=xlim.val,axes=F,ylab=NA,xlab=NA)
abline(v=xmin,lty=2,col="grey80",lwd=0.75)
with(pie.site.inv,points(Sampling.Date,plot.val,pch="|",col=adjustcolor("red",0.5)))
axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"))
axis_fun(2,ymaj,ymaj,unique(pie.site.inv$site),cex=1)
box(lwd=1)
mtext(side=3,"Plum Island Ecosystems LTER - DSi data",cex=0.8,adj=0)
mtext(side=1,line=1.75,"Date (Month-Year)")

```


**Number of sites:** `r length(unique(pie.site.inv$site))`

**Mean number of site years (with >4 samples per calendar year):** `r round(mean(ddply(subset(pie.site.yrs,n.val>4),"site",summarise,n.val=N.obs(CY))$n.val),2)`

<br>

## Ipswich (non-LTER)
```{r Ipswich_carey,fig.width=7,fig.height=5.5,fig.align='center',echo=FALSE,warning=FALSE, message=FALSE,fig.cap='Ipswich dataset period of record parameter inventory for all sites.'}

par(family="serif",mar=c(1,3,0.75,0.5),oma=c(2,6.5,0.5,0.5));

ylim.val=c(1,nrow(param.list));ymaj=seq(ylim.val[1],ylim.val[2],1)
plot(xlim.val,0:1,type="n",ylim=ylim.val,xlim=xlim.val,axes=F,ylab=NA,xlab=NA)
abline(v=xmin,h=ymaj,lty=2,col="grey80")
with(carey.dat.inv,points(Sampling.Date,plot.val,pch="|",col=adjustcolor("red",0.5)))
axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"))
axis_fun(2,ymaj,ymaj,param.list$variable,cex=0.8)
box(lwd=1)
mtext(side=3,"Ipswich",cex=0.8, adj=0)
mtext(side=1,line=1.75,"Date (Month-Year)")
```

```{r Ipswich_carey site,fig.width=6.5,fig.height=4,fig.align='center',echo=FALSE,warning=FALSE, message=FALSE,fig.cap='Silica data inventory for sites wihtin the Ipswich region. '}
carey.dat$site=carey.dat$`Site/Stream.Name`
carey.dat$CY=as.numeric(format(carey.dat$Sampling.Date,"%Y"))
carey.site.inv=ddply(carey.dat,c("Sampling.Date","site"),summarise,N.val=N.obs(DSi))
carey.site.inv=merge(carey.site.inv,data.frame(site=unique(carey.site.inv$site),plot.val=1:length(unique(carey.site.inv$site))))

carey.site.yrs=ddply(carey.dat,c("site","CY"),summarise,n.val=N.obs(DSi))

par(family="serif",mar=c(1,3,0.75,0.5),oma=c(2,6.5,0.5,0.5));

ylim.val=c(1,length(unique(carey.site.inv$site)));ymaj=seq(ylim.val[1],ylim.val[2],1)
plot(xlim.val,ylim.val,type="n",ylim=c(ylim.val[1],ylim.val[2]),xlim=xlim.val,axes=F,ylab=NA,xlab=NA)
abline(v=xmin,lty=2,col="grey80",lwd=0.75)
with(carey.site.inv,points(Sampling.Date,plot.val,pch="|",col=adjustcolor("red",0.5)))
axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"))
axis_fun(2,ymaj,ymaj,unique(carey.site.inv$site),cex=1)
box(lwd=1)
mtext(side=3,"Ipswich - DSi data",cex=0.8,adj=0)
mtext(side=1,line=1.75,"Date (Month-Year)")

```


**Number of sites:** `r length(unique(carey.site.inv$site))`

**Mean number of site years (with >4 samples per calendar year):** `r round(mean(ddply(subset(carey.site.yrs,n.val>4),"site",summarise,n.val=N.obs(CY))$n.val),2)`

<br>

## Upper Mississippi River (non-LTER)
```{r UMR,fig.width=7,fig.height=5.5,fig.align='center',echo=FALSE,warning=FALSE, message=FALSE,fig.cap='Upper Mississippi River dataset period of record parameter inventory for all sites.'}

par(family="serif",mar=c(1,3,0.75,0.5),oma=c(2,6.5,0.5,0.5));

ylim.val=c(1,nrow(param.list));ymaj=seq(ylim.val[1],ylim.val[2],1)
plot(xlim.val,0:1,type="n",ylim=ylim.val,xlim=xlim.val,axes=F,ylab=NA,xlab=NA)
abline(v=xmin,h=ymaj,lty=2,col="grey80")
with(umr.dat.inv,points(Sampling.Date,plot.val,pch="|",col=adjustcolor("red",0.5)))
axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"))
axis_fun(2,ymaj,ymaj,param.list$variable,cex=0.8)
box(lwd=1)
mtext(side=3,"Upper Mississippi River",cex=0.8, adj=0)
mtext(side=1,line=1.75,"Date (Month-Year)")

```

```{r UMR site,fig.width=6.5,fig.height=5,fig.align='center',echo=FALSE,warning=FALSE, message=FALSE,fig.cap='Silica data inventory for sites wihtin the Upper Mississippi River region. '}
umr.dat$site=umr.dat$`Site/Stream.Name`
umr.dat$CY=as.numeric(format(umr.dat$Sampling.Date,"%Y"))
umr.site.inv=ddply(umr.dat,c("Sampling.Date","site"),summarise,N.val=N.obs(DSi))
umr.site.inv=merge(umr.site.inv,data.frame(site=unique(umr.site.inv$site),plot.val=1:length(unique(umr.site.inv$site))))

umr.site.yrs=ddply(umr.dat,c("site","CY"),summarise,n.val=N.obs(DSi))

par(family="serif",mar=c(1,3,0.75,0.5),oma=c(2,6.5,0.5,0.5));

ylim.val=c(1,length(unique(umr.site.inv$site)));ymaj=seq(ylim.val[1],ylim.val[2],1)
plot(xlim.val,ylim.val,type="n",ylim=c(ylim.val[1],ylim.val[2]),xlim=xlim.val,axes=F,ylab=NA,xlab=NA)
abline(v=xmin,lty=2,col="grey80",lwd=0.75)
with(umr.site.inv,points(Sampling.Date,plot.val,pch="|",col=adjustcolor("red",0.5)))
axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"))
axis_fun(2,ymaj,ymaj,unique(umr.site.inv$site),cex=1)
box(lwd=1)
mtext(side=3,"Upper Mississippi River - DSi data",cex=0.8,adj=0)
mtext(side=1,line=1.75,"Date (Month-Year)")

```


**Number of sites:** `r length(unique(umr.site.inv$site))`

**Mean number of site years (with >4 samples per calendar year):** `r round(mean(ddply(subset(umr.site.yrs,n.val>4),"site",summarise,n.val=N.obs(CY))$n.val),2)`

<br>

## Kissimmee River (non-LTER)
```{r KRR,fig.width=7,fig.height=5.5,fig.align='center',echo=FALSE,warning=FALSE, message=FALSE,fig.cap='Kissimmee River dataset period of record parameter inventory for all sites.'}

par(family="serif",mar=c(1,3,0.75,0.5),oma=c(2,6.5,0.5,0.5));

ylim.val=c(1,nrow(param.list));ymaj=seq(ylim.val[1],ylim.val[2],1)
plot(xlim.val,0:1,type="n",ylim=ylim.val,xlim=xlim.val,axes=F,ylab=NA,xlab=NA)
abline(v=xmin,h=ymaj,lty=2,col="grey80")
with(KRR.dat.inv,points(Sampling.Date,plot.val,pch="|",col=adjustcolor("red",0.5)))
axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"))
axis_fun(2,ymaj,ymaj,param.list$variable,cex=0.8)
box(lwd=1)
mtext(side=3,"Kissimmee River",cex=0.8,adj=0)
mtext(side=1,line=1.75,"Date (Month-Year)")

```

```{r KRR site,fig.width=6.5,fig.height=5,fig.align='center',echo=FALSE,warning=FALSE, message=FALSE,fig.cap='Silica data inventory for sites wihtin the Kissimmee River. '}
KRR.dat$site=KRR.dat$`Site/Stream.Name`
KRR.dat$CY=as.numeric(format(KRR.dat$Sampling.Date,"%Y"))
KRR.site.inv=ddply(KRR.dat,c("Sampling.Date","site"),summarise,N.val=N.obs(DSi))
KRR.site.inv=merge(KRR.site.inv,data.frame(site=unique(KRR.site.inv$site),plot.val=1:length(unique(KRR.site.inv$site))))

KRR.site.yrs=ddply(KRR.dat,c("site","CY"),summarise,n.val=N.obs(DSi))

par(family="serif",mar=c(1,3,0.75,0.5),oma=c(2,6.5,0.5,0.5));

ylim.val=c(1,length(unique(KRR.site.inv$site)));ymaj=seq(ylim.val[1],ylim.val[2],1)
plot(xlim.val,ylim.val,type="n",ylim=c(ylim.val[1],ylim.val[2]),xlim=xlim.val,axes=F,ylab=NA,xlab=NA)
abline(v=xmin,lty=2,col="grey80",lwd=0.75)
with(KRR.site.inv,points(Sampling.Date,plot.val,pch="|",col=adjustcolor("red",0.5)))
axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"))
axis_fun(2,ymaj,ymaj,unique(KRR.site.inv$site),cex=1)
box(lwd=1)
mtext(side=3,"Kissimmee River - DSi data",cex=0.8,adj=0)
mtext(side=1,line=1.75,"Date (Month-Year)")

```


**Number of sites:** `r length(unique(KRR.site.inv$site))`

**Mean number of site years (with >4 samples per calendar year):** `r round(mean(ddply(subset(KRR.site.yrs,n.val>4),"site",summarise,n.val=N.obs(CY))$n.val),2)`

<br>

## Luquillo LTER
```{r LUQ,fig.width=7,fig.height=5.5,fig.align='center',echo=FALSE,warning=FALSE, message=FALSE,fig.cap='Luquillo LTER period of record parameter inventory for all sites.'}
par(family="serif",mar=c(1,3,0.75,0.5),oma=c(2,6.5,0.5,0.5));

ylim.val=c(1,nrow(param.list));ymaj=seq(ylim.val[1],ylim.val[2],1)
plot(xlim.val,0:1,type="n",ylim=ylim.val,xlim=xlim.val,axes=F,ylab=NA,xlab=NA)
abline(v=xmin,h=ymaj,lty=2,col="grey80")
with(LUQ.dat.inv,points(Sampling.Date,plot.val,pch="|",col=adjustcolor("red",0.5)))
axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"))
axis_fun(2,ymaj,ymaj,param.list$variable,cex=0.8)
box(lwd=1)
mtext(side=3,"Luquillo LTER",cex=0.8,adj=0)
mtext(side=1,line=1.75,"Date (Month-Year)")

```

```{r LUQ site,fig.width=6.5,fig.height=5,fig.align='center',echo=FALSE,warning=FALSE, message=FALSE,fig.cap='Silica data inventory for sites wihtin the Luquillo LTER. '}
LUQ.dat$site=LUQ.dat$`Site/Stream.Name`
LUQ.dat$CY=as.numeric(format(LUQ.dat$Sampling.Date,"%Y"))
LUQ.site.inv=ddply(LUQ.dat,c("Sampling.Date","site"),summarise,N.val=N.obs(DSi))
LUQ.site.inv=merge(LUQ.site.inv,data.frame(site=unique(LUQ.site.inv$site),plot.val=1:length(unique(LUQ.site.inv$site))))

LUQ.site.yrs=ddply(LUQ.dat,c("site","CY"),summarise,n.val=N.obs(DSi))

par(family="serif",mar=c(1,3,0.75,0.5),oma=c(2,6.5,0.5,0.5));

ylim.val=c(1,length(unique(LUQ.site.inv$site)));ymaj=seq(ylim.val[1],ylim.val[2],1)
plot(xlim.val,ylim.val,type="n",ylim=c(ylim.val[1],ylim.val[2]),xlim=xlim.val,axes=F,ylab=NA,xlab=NA)
abline(v=xmin,lty=2,col="grey80",lwd=0.75)
with(LUQ.site.inv,points(Sampling.Date,plot.val,pch="|",col=adjustcolor("red",0.5)))
axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"))
axis_fun(2,ymaj,ymaj,unique(LUQ.site.inv$site),cex=1)
box(lwd=1)
mtext(side=3,"Luquillo LTER - DSi data",cex=0.8,adj=0)
mtext(side=1,line=1.75,"Date (Month-Year)")

```


**Number of sites:** `r length(unique(LUQ.site.inv$site))`

**Mean number of site years (with >4 samples per calendar year):** `r round(mean(ddply(subset(LUQ.site.yrs,n.val>4),"site",summarise,n.val=N.obs(CY))$n.val),2)`

<br>

## McMurdo Dry Valleys LTER
```{r MCM,fig.width=7,fig.height=5.5,fig.align='center',echo=FALSE,warning=FALSE, message=FALSE,fig.cap='McMurdo Dry Valleys LTER period of record parameter inventory for all sites.'}
par(family="serif",mar=c(1,3,0.75,0.5),oma=c(2,6.5,0.5,0.5));

ylim.val=c(1,nrow(param.list));ymaj=seq(ylim.val[1],ylim.val[2],1)
plot(xlim.val,0:1,type="n",ylim=ylim.val,xlim=xlim.val,axes=F,ylab=NA,xlab=NA)
abline(v=xmin,h=ymaj,lty=2,col="grey80")
with(MCM.dat.inv,points(Sampling.Date,plot.val,pch="|",col=adjustcolor("red",0.5)))
axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"))
axis_fun(2,ymaj,ymaj,param.list$variable,cex=0.8)
box(lwd=1)
mtext(side=3,"McMurdo Dry Valleys LTER",cex=0.8,adj=0)
mtext(side=1,line=1.75,"Date (Month-Year)")

```

```{r MCM site,fig.width=6.5,fig.height=5,fig.align='center',echo=FALSE,warning=FALSE, message=FALSE,fig.cap='Silica data inventory for sites wihtin the McMurdo Dry Valleys LTER. '}
MCM.dat$site=MCM.dat$`Site/Stream.Name`
MCM.dat$CY=as.numeric(format(MCM.dat$Sampling.Date,"%Y"))
MCM.site.inv=ddply(MCM.dat,c("Sampling.Date","site"),summarise,N.val=N.obs(DSi))
MCM.site.inv=merge(MCM.site.inv,data.frame(site=unique(MCM.site.inv$site),plot.val=1:length(unique(MCM.site.inv$site))))

MCM.site.yrs=ddply(MCM.dat,c("site","CY"),summarise,n.val=N.obs(DSi))

par(family="serif",mar=c(1,3,0.75,0.5),oma=c(2,6.5,0.5,0.5));

ylim.val=c(1,length(unique(MCM.site.inv$site)));ymaj=seq(ylim.val[1],ylim.val[2],1)
plot(xlim.val,ylim.val,type="n",ylim=c(ylim.val[1],ylim.val[2]),xlim=xlim.val,axes=F,ylab=NA,xlab=NA)
abline(v=xmin,lty=2,col="grey80",lwd=0.75)
with(MCM.site.inv,points(Sampling.Date,plot.val,pch="|",col=adjustcolor("red",0.5)))
axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"))
axis_fun(2,ymaj,ymaj,unique(MCM.site.inv$site),cex=1)
box(lwd=1)
mtext(side=3,"McMurdo Dry Valleys LTER - DSi data",cex=0.8,adj=0)
mtext(side=1,line=1.75,"Date (Month-Year)")

```


**Number of sites:** `r length(unique(MCM.site.inv$site))`

**Mean number of site years (with >4 samples per calendar year):** `r round(mean(ddply(subset(MCM.site.yrs,n.val>4),"site",summarise,n.val=N.obs(CY))$n.val),2)`

<br>

<br>

***

# 

Updated `r format(Sys.Date(),"%d %b %Y")`

```{r,include=FALSE,echo=FALSE,warning=FALSE, message=FALSE}
# devtools::install_github("ropenscilabs/icon")
library(icon)
```

Created and Maintained by Paul Julian, PhD PWS  [`r icon::fa("envelope")`](mailto:pauljulianphd@gmail.com) [`r icon::fa("chrome")`](https://swampthingecology.org) [`r icon::fa("twitter")`](https://twitter.com/SwampThingPaul) [`r icon::fa("github")`](https://github.com/SwampThingPaul)   

Code hosted at [`r icon::fa("github")`](https://github.com/SwampThingPaul/SiSyn)